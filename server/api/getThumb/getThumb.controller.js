'use strict';



var config = require('../../config/environment');
var firebase = require("firebase-admin");


/* 
* get filename and token and generate a thumbnail for uploaded video
* This api call generated by cloud function from Firebase
*/

exports.index = function(req, res) {

	var token = (req.param('token')) 
	var filename = (req.param('filename')) 

	firebase.auth().verifyIdToken(token).then(function(decodedToken) {
	    var uid = decodedToken.uid;
	    res.json({uid: uid});
	    var db = firebase.database();
	    // var ref = db.ref("c").child(uid);


	    // ref.once("value", function(snapshot) {
	    // 	//output the data
	    // 	if (snapshot.val())
	    // 		res.json({status: 1, userObject: snapshot.val()});
	    // 	else
	    // 		res.json({status: 0});
	    // });

	}).catch(function(error) {
	    // Handle error
	 	var ret = {'status': 0};

		if (config.env == 'development'){
			ret['info'] = error;
		}
		res.json(ret);
	});





};